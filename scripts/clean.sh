#!/bin/bash

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${BLUE}โ                                                          โ${NC}"
echo -e "${BLUE}โ        ๐งน LolTimeFlash Monorepo - Deep Clean ๐งน         โ${NC}"
echo -e "${BLUE}โ                                                          โ${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""

# Function to clean a directory
clean_dir() {
  local dir=$1
  local name=$2
  
  if [ -d "$dir" ]; then
    echo -e "${YELLOW}๐๏ธ  Cleaning $name...${NC}"
    rm -rf "$dir"
    echo -e "${GREEN}โ $name cleaned${NC}"
  else
    echo -e "${BLUE}โน๏ธ  $name not found (already clean)${NC}"
  fi
}

# Get the root directory
ROOT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
cd "$ROOT_DIR"

echo -e "${YELLOW}๐ Working directory: $ROOT_DIR${NC}"
echo ""

# ============================================================================
# ROOT LEVEL CLEANUP
# ============================================================================
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${BLUE}  ROOT LEVEL CLEANUP${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
clean_dir "node_modules" "Root node_modules"
clean_dir ".turbo" "Turborepo cache"
clean_dir "pnpm-lock.yaml" "Root lock file"
echo ""

# ============================================================================
# FRONTEND (apps/web) CLEANUP
# ============================================================================
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${BLUE}  FRONTEND (apps/web) CLEANUP${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
clean_dir "apps/web/node_modules" "Frontend node_modules"
clean_dir "apps/web/.next" "Next.js build cache"
clean_dir "apps/web/.turbo" "Frontend Turbo cache"
clean_dir "apps/web/dist" "Frontend dist"
echo ""

# ============================================================================
# BACKEND (apps/api) CLEANUP
# ============================================================================
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${BLUE}  BACKEND (apps/api) CLEANUP${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
clean_dir "apps/api/node_modules" "Backend node_modules"
clean_dir "apps/api/dist" "Backend dist"
clean_dir "apps/api/.turbo" "Backend Turbo cache"
echo ""

# ============================================================================
# PACKAGES CLEANUP
# ============================================================================
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${BLUE}  PACKAGES CLEANUP${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
clean_dir "packages/shared/node_modules" "Shared node_modules"
clean_dir "packages/shared/dist" "Shared dist"
clean_dir "packages/eslint-config/node_modules" "ESLint config node_modules"
echo ""

# ============================================================================
# OLD BACKEND CLEANUP (BackLolTimeFlash)
# ============================================================================
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${BLUE}  OLD BACKEND CLEANUP (BackLolTimeFlash)${NC}"
echo -e "${BLUE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
clean_dir "BackLolTimeFlash/node_modules" "Old backend node_modules"
clean_dir "BackLolTimeFlash/pnpm-lock.yaml" "Old backend lock file"
echo ""

# ============================================================================
# SUMMARY
# ============================================================================
echo -e "${GREEN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo -e "${GREEN}โ                                                          โ${NC}"
echo -e "${GREEN}โ              โจ Cleanup Complete! โจ                     โ${NC}"
echo -e "${GREEN}โ                                                          โ${NC}"
echo -e "${GREEN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
echo ""
echo -e "${YELLOW}๐ Next steps:${NC}"
echo -e "   ${BLUE}1.${NC} Run ${GREEN}pnpm install${NC} or ${GREEN}pnpm get_started${NC}"
echo -e "   ${BLUE}2.${NC} Run ${GREEN}pnpm dev${NC} to start development"
echo ""

